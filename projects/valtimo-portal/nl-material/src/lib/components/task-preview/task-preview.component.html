<div @fadeIn>
  <nl-material-card
    *ngIf="(currentLang$ | async) as currentLang"
    [buttonText]="'home.preview.primaryButtonText' | translate"
    [secondaryButtonText]="'home.preview.secondaryButtonText' | translate"
    [title]="preview.caseDefinitionId + '.tasks.' + preview.taskDefinitionKey | translate"
    [subtitle]="preview.caseDefinitionId + '.title' | translate"
    (primaryButtonClick)="navigateToTask()"
    [type]="!preview.isCompleted ? taskPreviewType : taskPreviewCompletedType"
    [ngClass]="{'completed': preview.isCompleted}"
  >
    <ng-container *ngTemplateOutlet="extras"></ng-container>
    <ng-container
      *ngTemplateOutlet="currentTaskActions;context:{currentLang: currentLang, preview: preview}">
    </ng-container>
  </nl-material-card>
</div>

<ng-template #extras>
  <div class="top-right-fold"></div>
</ng-template>

<ng-template #currentTaskActions let-currentLang="currentLang" let-preview="preview">
  <div
    class="current-task-actions"
  >
      <span>
        {{preview.createdOn | date: 'shortDate' : '' : currentLang}}
      </span>
    <button
      *ngIf="!preview.isCompleted"
      mat-button
      [routerLink]="taskRoute$ | async"
      [queryParams]="{id:preview.taskId}"
    >
      <mat-icon fontIcon="fa-arrow-right" fontSet="fa"></mat-icon>
    </button>
  </div>
</ng-template>
